#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import pandas as pd
import re

# 사용자가 제공한 텍스트 데이터
user_text = """참여 리빙 2025 메가주 일산(하)
국내 최대 규모 펫페어 11월 메가주 일산 무료관람하기
오늘 단가 2,200원  오늘 잔여 880건

참여 경영/창업 술속의밤 창업
수익률 30%유지! 돈잘버는 베짱이 창업!
오늘 단가 54,000원  오늘 잔여 8건

참여 리빙 10월 킨텍스코베 베이비페어 무료입장
최대 규모 최다 브랜드 10월 킨텍스 코베 베이비페어 유아교육전
오늘 단가 2,475원  오늘 잔여 364건

참여 리빙 알칼리 이온수기
물은 다 똑같은 거 아니야? 이유있는 소비자들의 선택
오늘 단가 14,000원  오늘 잔여 10건

참여 병원 젬마의원 모발이식 시술
20년전 가격 그대로! 비절개 모발이식 99만원
오늘 단가 24,000원  잔여 무제한

참여 병원 젬마의원 모발이식 시술
20년전 가격 그대로! 비절개 모발이식 99만원
오늘 단가 24,000원  잔여 무제한

참여 보험 메리츠파트너스
1시간 투자, 월평균 148만원 버는 고효율 부업
오늘 단가 32,500원  잔여 무제한

참여 경영/창업 오마뎅
프리미엄 분식 브랜드, 오마뎅
오늘 단가 36,000원  오늘 잔여 8건

참여 경영/창업 미라트스튜디오
미라트스튜디오 예비점주 DB모집
오늘 단가 55,000원  오늘 잔여 14건

참여 자동차 장기렌트 기획전
신차 장기렌트, 겟차에서 특판견적을 받아보세요.
오늘 단가 20,000원  오늘 잔여 27건

창업상담DB모집 경영/창업 원할머니 보쌈족발
대한민국 보쌈의 원조, 원할머니 보쌈족발
오늘 단가 42,000원  오늘 잔여 6건

참여 경영/창업 박가부대
대한민국 대표 프리미엄 부대찌개, 박가부대
오늘 단가 42,000원  오늘 잔여 8건

참여 자동차 BYD 1톤 전기트럭 T4K 냉동탑차
BYD 1톤 EV 냉동탑 최대 2,727만원 할인 & 내장탑 실구매가 2,110만원, 사전계약 진행중
오늘 단가 16,500원  오늘 잔여 8건

참여 IT 블랙박스분석
매월 GS칼텍스 주유권 받고, 교통사고 과실 피해도 예방하자!
오늘 단가 1,625원  오늘 잔여 392건

참여 리빙 엔노블 결혼테스트
연프 속 이상형, 어디서 만날 수 있을까?
오늘 단가 5,000원  오늘 잔여 99건

참여 리빙 엔노블 연애성향 테스트
에겐 vs 테토, 당신은 어떤 스타일?
오늘 단가 5,000원  오늘 잔여 94건

참여 자동차 카바 - 신차구매 딜러찾기 서비스
신차구매 예정이신가요? 딜러서비스 비교 '카바딜러'
오늘 단가 3,850원  오늘 잔여 125건

참여 금융 코인 정보 무료로 공유해 드립니다
코인 정보방 무료 입장
오늘 단가 12,100원  오늘 잔여 22건

참여 교육 smartall 올탭과외
중학생 맞춤 1:1 과외 시스템
오늘 단가 15,909원  오늘 잔여 4건

참여 금융 라쿠텐 인사이트 서베이
설문조사하고 용돈벌자! 라쿠텐 인사이트 서베이
오늘 단가 3,000원  오늘 잔여 14건

참여 리빙 온도와 전기요금을 낮추는 차열페인트
실내온도 6℃, 전기요금 35%! 차열페인트
오늘 단가 26,455원  오늘 잔여 8건

참여 리빙 사장님이 행복한, 요기오더
테블릿오더로 인건비 80% 줄고 매출 130% 오른 기적!
오늘 단가 26,455원  오늘 잔여 5건

참여 리빙 한샘리하우스샘
한샘 인테리어 프리미엄 강마루 증정 혜택!
오늘 단가 35,200원  오늘 잔여 2건

참여 교육 하루 20분, 영어스피킹 링고시티
아이가 먼저 찾는 진짜 영어 스피킹!
오늘 단가 11,363원  오늘 잔여 10건

참여 뷰티 채연 두빼빼 체인지업
채연 감량 비결 두빼빼 체인지업
오늘 단가 17,500원  오늘 잔여 1건

참여 경영/창업 뚜레쥬르
매일매일(Tous Les Jours) 건강한 베이커리, 뚜레쥬르
오늘 단가 36,000원  오늘 잔여 6건

참여 리빙 이사타임
이사업체 3곳 비교견적을 단 한번에, 이사견적플랫폼 '이사타임'
오늘 단가 11,400원  오늘 잔여 56건

참여 리빙 모두클린
좋은 청소업체를 찾는 가장 쉬운 방법, 모두클린
오늘 단가 6,000원  오늘 잔여 25건

참여 리빙 모두이사
포장이사 고객 맞춤 비교 견적 플랫폼 '모두이사'
오늘 단가 16,800원  오늘 잔여 34건

참여 리빙 서경석의 이사방
한 번의 견적 신청으로 '서경석의 이사방' 우수지점 2곳의 견적을 받아보세요
오늘 단가 14,520원  오늘 잔여 18건

참여 리빙 서경석의 이사방 청소서비스
서경석의 이사방 깔끔 똑똑 청소서비스
오늘 단가 8,000원  오늘 잔여 39건

참여 자동차 장기렌트 가격비교 카빌리지
장기렌트 가격비교 카빌리지 신차광 브라이언
오늘 단가 27,000원  오늘 잔여 6건

견적접수완료 IT 폰가비 중고폰매입
다음주면 매입가 떨어져요! 지금 중고폰 최고가로 파는방법, 폰가비
오늘 단가 10,000원  잔여 무제한

참여 리빙 휴대폰가족보호
휴대폰가족보호 인증만하면 커피드려요!
오늘 단가 2,400원  오늘 잔여 29건

참여 IT 휴대폰분실보호
휴대폰분실보호 인증만하면 커피드려요!
오늘 단가 2,400원  오늘 잔여 30건

참여 금융 머니트리카드
발급 조건 없이 누구나 발급 가능한 머니트리카드
오늘 단가 4,800원  오늘 잔여 233건

참여 엔터테인먼트 나이스지키미 신규 회원가입
나이스지키미 이름어때 서비스(모바일 전용)
오늘 단가 1,375원  오늘 잔여 77건

참여 교육 엘리하이 키즈 무료체험 신청
초등 대세 엘리하이가 만든 유아학습지 '엘리하이 키즈'
오늘 단가 33,000원  오늘 잔여 20건

참여 자동차 오토리스&신차장기렌트
신차장기렌트카 전렌트사 가격비교 전문업체 ONEPICK원픽
오늘 단가 22,500원  오늘 잔여 5건

참여 교육 에듀윌 공무원
[에듀윌 공무원] 굿노트속지 100% 무료배포!
오늘 단가 2,500원  오늘 잔여 49건

참여 리빙 엔노블 배우자직업 테스트
나의 미래 배우자의 직업은?
오늘 단가 5,000원  오늘 잔여 48건

참여 리빙 엔노블 연애스타일 테스트
나에게 어울리는 연애스타일 알아보기!
오늘 단가 5,000원  오늘 잔여 50건

참여 리빙 엔노블 결혼매력도 테스트
나는 결혼 상대자로서 매력적일까?
오늘 단가 5,000원  오늘 잔여 44건

참여 리빙
우리집 청소비용 얼마? "클린데이즈"에서 무료 견적 받으세요!
오늘 단가 6,750원  오늘 잔여 25건

참여 리빙 엔노블 가입비 테스트
결혼정보회사에서 내 가입비는 얼마일까?
오늘 단가 5,000원  오늘 잔여 42건

참여 리빙 엔노블 나의 노블레스 점수 테스트
나의 노블레스 점수는 몇점일까? 엔노블에서 확인해보세요!
오늘 단가 5,000원  오늘 잔여 44건

참여 리빙 엔노블 이상형 찾기 테스트
나에게 딱 맞는 이상형, 엔노블에서 찾아보세요!
오늘 단가 5,000원  오늘 잔여 49건

참여 IT 원키퍼
AI로 보이스피싱 막고, GS25 상품권 받자!
오늘 단가 1,320원  오늘 잔여 17건

참여 자동차 넥센타이어렌탈
아직도 몰라요? 10월 최대 상품권 4종 총모음, 끝나기 전에 서두르세요!
오늘 단가 6,600원  오늘 잔여 210건

참여 IT 원키퍼
AI로 보이스피싱 막고, GS25 상품권 받자!
오늘 단가 1,120원  오늘 잔여 30건

참여 리빙 위매치다이사
나쁜이사를 피하는 방법 : 내주변 모든 이사업체 비교하기
오늘 단가 16,000원  오늘 잔여 23건

참여 교육 엘리하이
전 과목 스타 선생님+영수 심화+영재교육원까지! 초등 인강 '엘리하이'
오늘 단가 44,000원  오늘 잔여 23건

참여 교육 엠베스트
공부 잘하는 중학생의 시작, 엠베스트를 지금 무료로 만나보세요!
오늘 단가 38,500원  오늘 잔여 71건

참여 IT USIM 스마트 인증
내 스마트폰이 해킹당하고 있다? 지금 무료로 확인하세요!
오늘 단가 1,250원  오늘 잔여 199건

참여 경영/창업 대한판촉(주) 판촉물창업
대한판촉(주) 판촉물창업 48만원! 무점포,무재고,소자본,투잡형창업
오늘 단가 16,800원  오늘 잔여 15건

참여 엔터테인먼트 무툰
웹툰 '독고' 쌍둥이 형의 복수를 위해 일진회를 박살낸다.
오늘 단가 1,200원  오늘 잔여 66건

참여 엔터테인먼트 파일마루
'파일마루'에서 만나는 최신 자료, 지금 회원가입 하세요
오늘 단가 1,020원  잔여 무제한

참여 경영/창업 뿌리오
뿌리오가 드리는 문자 특가 9.1원, 58% 할인 놓치지 마세요
오늘 단가 2,500원  오늘 잔여 88건"""

def parse_user_campaigns():
    campaigns = []
    blocks = user_text.strip().split('\n\n')

    for block in blocks:
        lines = [line.strip() for line in block.split('\n') if line.strip()]

        if len(lines) < 3:
            continue

        campaign_data = {}

        # 첫 번째 줄 파싱
        first_line_parts = lines[0].split(None, 2)
        if len(first_line_parts) >= 3:
            campaign_data['campaign_type'] = first_line_parts[0]
            campaign_data['category'] = first_line_parts[1]
            campaign_data['title'] = first_line_parts[2]
        elif len(first_line_parts) == 2:
            campaign_data['campaign_type'] = first_line_parts[0]
            campaign_data['category'] = ''
            campaign_data['title'] = first_line_parts[1]

        # 두 번째 줄: 설명
        if len(lines) > 1:
            campaign_data['description'] = lines[1]

        # 가격 및 잔여 정보
        for line in lines:
            if "오늘 단가" in line:
                if "오늘 잔여" in line:
                    parts = line.split("오늘 잔여")
                    price = parts[0].replace("오늘 단가", "").strip()
                    remaining = parts[1].strip()
                    campaign_data['price'] = price
                    campaign_data['remaining'] = remaining
                elif "잔여 무제한" in line:
                    parts = line.split("잔여 무제한")
                    price = parts[0].replace("오늘 단가", "").strip()
                    campaign_data['price'] = price
                    campaign_data['remaining'] = "무제한"

        if 'title' in campaign_data:
            campaigns.append(campaign_data)

    return campaigns


def create_excel_with_sheets():
    # 스크래핑한 데이터 로드
    df_scraped = pd.read_excel('adtenping_campaigns.xlsx')

    # 사용자 데이터 파싱
    user_campaigns = parse_user_campaigns()
    df_user = pd.DataFrame(user_campaigns)

    # 엑셀 파일에 두 시트로 저장
    with pd.ExcelWriter('adtenping_campaigns.xlsx', engine='openpyxl') as writer:
        df_scraped.to_excel(writer, sheet_name='스크래핑 데이터', index=False)
        df_user.to_excel(writer, sheet_name='사용자 제공 데이터', index=False)

    print(f"스크래핑 데이터: {len(df_scraped)}개")
    print(f"사용자 제공 데이터: {len(df_user)}개")
    print("\n엑셀 파일 'adtenping_campaigns.xlsx'에 2개 시트로 저장되었습니다.")


if __name__ == "__main__":
    create_excel_with_sheets()
